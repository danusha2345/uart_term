# UART Терминал (`uart_term`)

Кроссплатформенный, быстрый и многофункциональный графический терминал для Serial (UART) и BLE, написанный на Rust с использованием фреймворка `egui`. Разработан специально для хардверной отладки, реверсинга и анализа бинарных протоколов (таких как протокол u-blox UBX).

## Основные возможности

- **Два COM-порта:** Одновременное подключение и мониторинг двух различных интерфейсов UART.
- **Bluetooth Low Energy (BLE):** Сканирование и подключение к BLE устройствам. Включает автоматическое определение сервиса **Nordic UART Service (NUS)** для беспроводной передачи данных.
- **Кастомные разделители пакетов:** Разбиение непрерывного потока байт на читаемые структурированные пакеты с помощью задаваемой последовательности байт (например, `B5 62` для u-blox GNSS) или стандартных символов (`\n`, `$`).
- **Форматы отображения:** Просмотр входящего и исходящего трафика в форматах **HEX**, **ASCII**, или комбинированном **HEX+ASCII**.
- **Фильтрация пакетов:** Фильтрация на лету по шестнадцатеричному префиксу (например, `B5 62 06 41`), чтобы изолировать нужные сообщения в плотном потоке данных.
- **Логирование:** Сохранение живого трафика в текстовый файл (`.txt` / `.log`) в выбранном формате для последующего анализа.
- **Управление линиями:** Ручное переключение контактов **DTR** и **RTS** для жесткого сброса микроконтроллеров или управления потоком.
- **Продвинутая отправка:** Отправка шестнадцатеричных payload-пакетов с настраиваемыми окончаниями строк (None, CR, LF, CRLF). Включает историю команд (доступна по стрелкам Вверх/Вниз).
- **Автопрокрутка и Таймлайн:** Плавная автопрокрутка логов с метками времени, направлением (RX/TX) и источником пакета.

## Стек технологий

Проект полностью написан на Rust и опирается на следующие библиотеки:
* **[eframe / egui](https://github.com/emilk/egui):** Библиотека GUI (Immediate mode).
* **[serialport](https://crates.io/crates/serialport):** Кроссплатформенный доступ к COM-портам.
* **[btleplug](https://crates.io/crates/btleplug):** Работа с Bluetooth Low Energy (BLE) на разных ОС.
* **[tokio](https://tokio.rs/):** Асинхронный рантайм для обработки BLE-событий.
* **[rfd](https://crates.io/crates/rfd):** Нативные системные диалоги для сохранения логов.

## Сборка и запуск

Убедитесь, что у вас установлены [Rust и Cargo](https://rustup.rs/).

### Зависимости (Linux)
На Linux для успешной компиляции `egui`, `btleplug` и `serialport` могут потребоваться системные библиотеки. Пример для Ubuntu/Debian:
```bash
sudo apt-get install -y libxkbcommon-dev libwayland-dev libudev-dev pkg-config libdbus-1-dev
```

### Компиляция

Для прямого запуска:
```bash
cargo run --release
```

Для сборки оптимизированного бинарного файла:
```bash
cargo build --release
```
Скомпилированный бинарник будет находиться по пути `target/release/uart_term`.

## Советы по использованию

1. **Отладка протокола UBX:** По умолчанию установлен разделитель `B5 62`. Терминал сам разобьет входящий поток байтов на правильные u-blox пакеты.
2. **Беспроводной UART (BLE):** Переключитесь в режим `BLE`, нажмите "Scan" и выберите устройство. Если оно использует стандартные характеристики TX/RX Nordic UART, приложение автоматически к ним подключится для двусторонней связи.
3. **Копирование данных:** Нажмите правой кнопкой мыши по любому пакету в логе, чтобы быстро скопировать его полезную нагрузку (payload) в буфер обмена в формате HEX или ASCII.
